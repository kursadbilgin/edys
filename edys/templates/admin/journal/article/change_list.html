{% extends 'admin/change_list.html' %}
{% load i18n admin_urls static admin_list %}

{% block header %}
  {% if not request.GET.journal %}
    {{ block.super}}
  {% endif %}
{% endblock %}

{% block object-tools-items %}
  {% if has_add_permission %}
    <li>
      {% if request.GET.journal %}
        <a class="open-popup" href="{% url 'admin:journal_article_add' %}?journal={{ request.GET.journal }}">{% trans 'Add Article' %}</a>
      {% else %}
        <a class="open-popup" href="{% url 'admin:journal_article_add' %}">{% trans 'Add Article' %}</a>
      {% endif %}
    </li>
  {% endif %}
{% endblock %}

{% block breadcrumbs %}
  <div class="breadcrumbs">
    {% if not request.GET.journal %}
      <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
      &rsaquo; <a href="{% url 'admin:app_list' app_label=cl.opts.app_label %}">{{ cl.opts.app_config.verbose_name }}</a>
      &rsaquo;
    {% endif %}{{ cl.opts.verbose_name_plural|capfirst }}
    {% if request.GET.journal %}
      <a style="position:absolute; right: 35px;" href="{% url 'admin:journal_article_changelist' %}?journal={{ request.GET.journal }}">
      </a>
    {% endif %}
  </div>

  <script type="text/javascript">
    (function($) {
      $(function(){
        $('#result_list th a').each(function(){
          var journal_id= "{{request.GET.journal}}"
          if(journal_id){
            $(this).attr('href', $(this).attr('href')+'&journal={{ request.GET.journal }}');
          }
        });
      });
    })(django.jQuery);
  </script>
{% endblock %}
